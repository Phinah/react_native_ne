{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { createContext, useState, useEffect } from \"react\";\nimport * as SecureStore from \"expo-secure-store\";\nimport { get } from \"../utils/http\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar AppContext = createContext();\n\nvar AppProvider = function AppProvider(_ref) {\n  var children = _ref.children;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isLoggedIn = _useState2[0],\n      setIsLoggedIn = _useState2[1];\n\n  var _useState3 = useState({}),\n      _useState4 = _slicedToArray(_useState3, 2),\n      authUser = _useState4[0],\n      setAuthUser = _useState4[1];\n\n  var _useState5 = useState(true),\n      _useState6 = _slicedToArray(_useState5, 2),\n      isLoading = _useState6[0],\n      setIsLoading = _useState6[1];\n\n  useEffect(function () {\n    (function _callee() {\n      var token, user;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(SecureStore.getItemAsync(\"token\"));\n\n            case 3:\n              token = _context.sent;\n\n              if (!token) {\n                _context.next = 12;\n                break;\n              }\n\n              _context.next = 7;\n              return _regeneratorRuntime.awrap(get(\"api/auth/profile\", {\n                headers: {\n                  Authorization: \"Bearer \" + token\n                }\n              }));\n\n            case 7:\n              user = _context.sent;\n              setAuthUser(user.data);\n              setIsLoggedIn(true);\n              _context.next = 14;\n              break;\n\n            case 12:\n              setIsLoggedIn(false);\n              setAuthUser({});\n\n            case 14:\n              setIsLoading(false);\n              _context.next = 22;\n              break;\n\n            case 17:\n              _context.prev = 17;\n              _context.t0 = _context[\"catch\"](0);\n              setIsLoggedIn(false);\n              setAuthUser({});\n              setIsLoading(false);\n\n            case 22:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, [[0, 17]], Promise);\n    })();\n  }, []);\n  return _jsx(AppContext.Provider, {\n    value: {\n      isLoggedIn: isLoggedIn,\n      setIsLoggedIn: setIsLoggedIn,\n      authUser: authUser,\n      setAuthUser: setAuthUser,\n      isLoading: isLoading\n    },\n    children: children\n  });\n};\n\nexport { AppContext, AppProvider };","map":{"version":3,"names":["createContext","useState","useEffect","SecureStore","get","AppContext","AppProvider","children","isLoggedIn","setIsLoggedIn","authUser","setAuthUser","isLoading","setIsLoading","getItemAsync","token","headers","Authorization","user","data"],"sources":["C:/Users/USER/Documents/mobile dev/nat-mobile-starter/client/contexts/app-context.jsx"],"sourcesContent":["import { createContext, useState, useEffect } from \"react\";\r\nimport * as SecureStore from \"expo-secure-store\";\r\nimport { get } from \"../utils/http\";\r\n\r\nconst AppContext = createContext();\r\n\r\nconst AppProvider = ({ children }) => {\r\n\tconst [isLoggedIn, setIsLoggedIn] = useState(false);\r\n\tconst [authUser, setAuthUser] = useState({});\r\n\r\n\tconst [isLoading, setIsLoading] = useState(true);\r\n\r\n\tuseEffect(() => {\r\n\t\t(async function () {\r\n\t\t\ttry {\r\n\t\t\t\tlet token = await SecureStore.getItemAsync(\"token\");\r\n\t\t\t\tif (token) {\r\n\t\t\t\t\tlet user = await get(\"api/auth/profile\", {\r\n\t\t\t\t\t\theaders: {\r\n\t\t\t\t\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tsetAuthUser(user.data);\r\n\t\t\t\t\tsetIsLoggedIn(true);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetIsLoggedIn(false);\r\n\t\t\t\t\tsetAuthUser({});\r\n\t\t\t\t}\r\n\t\t\t\tsetIsLoading(false);\r\n\t\t\t} catch (error) {\r\n\t\t\t\tsetIsLoggedIn(false);\r\n\t\t\t\tsetAuthUser({});\r\n\t\t\t\tsetIsLoading(false);\r\n\t\t\t}\r\n\t\t})();\r\n\t}, []);\r\n\r\n\treturn (\r\n\t\t<AppContext.Provider\r\n\t\t\tvalue={{\r\n\t\t\t\tisLoggedIn,\r\n\t\t\t\tsetIsLoggedIn,\r\n\t\t\t\tauthUser,\r\n\t\t\t\tsetAuthUser,\r\n\t\t\t\tisLoading,\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t{children}\r\n\t\t</AppContext.Provider>\r\n\t);\r\n};\r\n\r\nexport { AppContext, AppProvider };\r\n"],"mappings":";;AAAA,SAASA,aAAT,EAAwBC,QAAxB,EAAkCC,SAAlC,QAAmD,OAAnD;AACA,OAAO,KAAKC,WAAZ,MAA6B,mBAA7B;AACA,SAASC,GAAT;;AAEA,IAAMC,UAAU,GAAGL,aAAa,EAAhC;;AAEA,IAAMM,WAAW,GAAG,SAAdA,WAAc,OAAkB;EAAA,IAAfC,QAAe,QAAfA,QAAe;;EACrC,gBAAoCN,QAAQ,CAAC,KAAD,CAA5C;EAAA;EAAA,IAAOO,UAAP;EAAA,IAAmBC,aAAnB;;EACA,iBAAgCR,QAAQ,CAAC,EAAD,CAAxC;EAAA;EAAA,IAAOS,QAAP;EAAA,IAAiBC,WAAjB;;EAEA,iBAAkCV,QAAQ,CAAC,IAAD,CAA1C;EAAA;EAAA,IAAOW,SAAP;EAAA,IAAkBC,YAAlB;;EAEAX,SAAS,CAAC,YAAM;IACf,CAAC;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;cAAA;cAAA,iCAEmBC,WAAW,CAACW,YAAZ,CAAyB,OAAzB,CAFnB;;YAAA;cAEKC,KAFL;;cAAA,KAGKA,KAHL;gBAAA;gBAAA;cAAA;;cAAA;cAAA,iCAImBX,GAAG,CAAC,kBAAD,EAAqB;gBACxCY,OAAO,EAAE;kBACRC,aAAa,cAAYF;gBADjB;cAD+B,CAArB,CAJtB;;YAAA;cAIMG,IAJN;cAUEP,WAAW,CAACO,IAAI,CAACC,IAAN,CAAX;cACAV,aAAa,CAAC,IAAD,CAAb;cAXF;cAAA;;YAAA;cAaEA,aAAa,CAAC,KAAD,CAAb;cACAE,WAAW,CAAC,EAAD,CAAX;;YAdF;cAgBCE,YAAY,CAAC,KAAD,CAAZ;cAhBD;cAAA;;YAAA;cAAA;cAAA;cAkBCJ,aAAa,CAAC,KAAD,CAAb;cACAE,WAAW,CAAC,EAAD,CAAX;cACAE,YAAY,CAAC,KAAD,CAAZ;;YApBD;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CAAD;EAuBA,CAxBQ,EAwBN,EAxBM,CAAT;EA0BA,OACC,KAAC,UAAD,CAAY,QAAZ;IACC,KAAK,EAAE;MACNL,UAAU,EAAVA,UADM;MAENC,aAAa,EAAbA,aAFM;MAGNC,QAAQ,EAARA,QAHM;MAINC,WAAW,EAAXA,WAJM;MAKNC,SAAS,EAATA;IALM,CADR;IAAA,UASEL;EATF,EADD;AAaA,CA7CD;;AA+CA,SAASF,UAAT,EAAqBC,WAArB"},"metadata":{},"sourceType":"module"}